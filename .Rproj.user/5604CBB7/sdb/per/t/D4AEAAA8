{
    "contents" : "# Andrew Fairless, February 2011\n# modified May 2015 for posting onto Github\n# This script analyzes whether litter size affects sociability by running a\n# robust OP regression on the residuals of a trimmed means ANOVA with sex and \n# age as grouping factors in the C57BL/6J MICE, as described in Fairless et al 2012\n# Fairless et al 2012, doi: 10.1016/j.bbr.2011.12.001, PMID:  22178318, PMCID:  PMC3474345\n\n# The fictional data in \"altereddata.txt\" were modified from the original \n# empirical data used in Fairless et al 2012.\n# I am using fictional data instead of the original data because I do not have \n# permission of my co-authors to release the data into the public domain.  \n# NOTE:  Because these data are fictional, several important characteristics of\n# these data may be different from those of the original data.\n\n# Each row is a separate mouse.\n# The left-most 3 columns are quasi-independent variables (mouse strain, sex, and age).\n# The right-most 5 columns are dependent variables describing behaviors of the\n# mice during the Social Approach/Choice Test.\n\n# analysis as described in Fairless et al 2012:\n# \"This result was confirmed by a simple OP regression of litter size and the\n# residuals of a 2 Ã— 5 (sex by age) trimmed means ANOVA of social cylinder \n# investigation, which yielded a slope significantly less than zero, D = 0.004, \n# p < 0.001 (Fig. 3c).\"\n\nsource(\"Rallfun-v13.txt\")\n\nalldata = read.table(\"altereddata.txt\", header = TRUE)      \nstrainsplit = split(alldata, alldata$strain)\nmousestrain = 2\ndata = strainsplit[[mousestrain]]                                               # C57BL/6J mice only\ndepvarcol = 18                                                                  # dependent variable column; specifies 'soc.3rd5min'\ndatatemp = data.matrix(cbind(data[ , 2], data[ , 3], data[ , depvarcol]))       # creates matrix with only 'sex', 'age', and 'soc.3rd5min' variables\n\nmodel = t2way(2, 5, datatemp, MAT = T)            # robust trimmed means ANOVA\nmns = model$means                                 # table of means for each group defined by sex and age\nrownames(mns) = c(\"Female\", \"Male\")\ncolnames(mns) = c(\"20\", \"24\", \"32\", \"43\", \"71\")\n\n# adds column with group mean of 'soc.3rd5min' for each mouse\ndata[ , dim(data)[[2]] + 1] = NA                  \ncolnames(data)[dim(data)[[2]]] = \"groupmeans\"\nfor(iter in 1:dim(datatemp)[[1]]) {\n     if(datatemp[iter, 2] == 20) data[iter, dim(data)[[2]]] = mns[datatemp[iter, 1], 1]\n     if(datatemp[iter, 2] == 24) data[iter, dim(data)[[2]]] = mns[datatemp[iter, 1], 2]\n     if(datatemp[iter, 2] == 32) data[iter, dim(data)[[2]]] = mns[datatemp[iter, 1], 3]\n     if(datatemp[iter, 2] == 43) data[iter, dim(data)[[2]]] = mns[datatemp[iter, 1], 4]\n     if(datatemp[iter, 2] == 71) data[iter, dim(data)[[2]]] = mns[datatemp[iter, 1], 5]\n}\n\n# adds column with residual for each mouse (i.e., difference between each mouse's \n# score for 'soc.3rd5min' and the mouse's group mean as defined by sex and age)\nlastcol = dim(data)[[2]]\ndata[ , dim(data)[[2]] + 1] = data[ , depvarcol] - data[ , lastcol]\ncolnames(data)[dim(data)[[2]]] = \"resids\"\n\nstrainname = gsub(\"[[:punct:]]\", \"\", names(strainsplit)[mousestrain])   # removes \"/\" from strain name\nsink(file = paste(\"littersize,\", strainname, \".txt\", sep = \"\"))\n\npaste(\"This analysis covers the\", names(strainsplit)[mousestrain], \"mice\")\nprint(\"robust trimmed means ANOVA\")\npaste(\"The dependent variable is:  \", colnames(data)[depvarcol])\npaste(\"Factor 1 or A is:  \", colnames(data)[2])\npaste(\"Factor 2 or B is:  \", colnames(data)[3])\nt2way(2, 5, datatemp, MAT = T)\n\n# robust OP regression on litter size and the residuals of the trimmed means ANOVA\nopreg(data$littersize, data$resids)\n# tests whether slope of regression line is significantly different from zero\nregtest(data$littersize, data$resids, regfun = opreg, nboot = 1000, plotit = TRUE, grp = c(1))\nprint(\"'$test' denotes test statistic value\")\nprint(\"'$crit' denotes critical value for test statistic\")\nprint(\"'$p.value' denotes p value for test statistic\")\n\nsink(file = NULL)\n",
    "created" : 1433116565806.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "266299082",
    "id" : "D4AEAAA8",
    "lastKnownWriteTime" : 1433116303,
    "path" : "/media/zh/My Passport/backup/2015 code share/Fairless et al 2012 littersize B6s/to share/revising.R",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}